<template>
    <div class="page" data-name="createscanner">
        <div class="bottombox box">
            <div class="opretBrugerGruppe boxtitle">Opret scanner</div>

            <div style="width: 90%;margin-left:5%;">
                <div class="inputfieldtitle">MAC adresse</div>
                <input autocomplete="off" id="cs_MAC" class="inputfield" type="text" name="scMAC">

                <div class="inputfieldtitle">Navn</div>
                <input autocomplete="off" id="cs_name" class="inputfield" type="text" name="SCname">
            </div>
            <div class="btnbox">
                <div style="display: inline-block;">
                    <a @click="createScanner" class="newbtnstyle noSelect">Opret scanner</a>
                </div>
            </div>
        </div>
    </div>
</template>

<script>
    return {

        /**
         * Det datasæt som framework bruger internt i dette view, de kan ikke tilgås udefra.
         */
        data: function () {
            return {
            };
        },

        // Framework7 Component Methods
        methods: {
            createScanner: function () {
                let MAC = $$('#cs_MAC').val();
                let name = $$('#cs_name').val();
                if (MAC == "" || name == "") {
                    app.methods.statusMsg("Alle felter skal være udfyldt", "error", ".opretBrugerGruppe");
                    return;
                }

                app.request.post(`${app.data['serverIP']}endpoints/web/postCreateScanner.php`, {
                    MAC: MAC,
                    name: name,
                    userID: app.data['userID'],
                    token: app.data['token'],
                }, function (response) {
                    if (response.result == 0) {
                        app.methods.statusMsg(response.message, "error", ".opretBrugerGruppe");
                        return;
                    } else {
                        app.methods.statusMsg(response.message, "success", ".opretBrugerGruppe");
                        setTimeout(function () { app.views.main.router.navigate("/createscanner/", { reloadCurrent: true, }) }, 3000);

                    }
                }, function (e, e2) { console.error(e); console.error(e2) }, "json");
            },

        },
        on: {
            //pageMounted trigger når siden bliver insat i DOMen
            pageMounted: function (page) {

            },
        },
    }


</script>