<template>
    <div class="page" data-name="navbar" id="navbar">
        <div class="navlogo">
            <a class="centerlogo" href="/currentDay/" data-view=".view-main"><img class="centerlogo"
                    src="../images/logo.png"></a>
        </div>
        <div class="profilearea">
            <img class="profilepic" src="">
            <span class="usernamefield"></span>
        </div>
        <ul>
            <li class="navright">
                <a href="/currentDay/" id="navcurrentDay"  data-view=".view-main"><span
                        class="fas fa-home aicon"></span>Dagsoversigt</a>
            </li>
            <li class="navright">
                <a href="/overview/" id="navoverview" data-view=".view-main"><span
                        class="fas fa-history aicon"></span>Årsoversigt</a>
            </li>
            <li class="navright">
                <a href="/editprofile/" id="naveditprofile" data-view=".view-main"><span
                        class="fas fa-cogs aicon"></span>Profil</a>
            </li>
            <li class="navright">
                <a href="/groupoverview/" id="navgroupoverview" data-view=".view-main"><span
                        class="fas fa-users aicon"></span>Lokaleoversigt</a>
            </li>
            <li class="navright accordion-item" id="navadminaccordion" style="display:none">
                <a href="#" id="navtimemain" class="item-content item-link">
                    <div class="item-inner">
                        <div class="item-title"><span class="fas fa-user-cog aicon"></span>Administrator<span
                                class="fas fa-chevron-right aicon dropboi" style="float:right;margin-top:5px;"></span>
                        </div>
                    </div>
                </a>
                <div class="accordion-item-content" style="color: white">
                    <div class="block">
                        <a href="/createuser/" id="navcreateuser" data-view=".view-main"><span
                                class="fas fa-user-plus aicon"></span>Opret bruger</a>
                    </div>
                    <div class="block">
                        <a href="/createusergroup/" id="navcreateusergroup" data-view=".view-main"><span
                                class="fas fa-users-cog aicon"></span>Opret lokale/område</a>
                    </div>
                    <div class="block">
                        <a href="/createscanner/" id="navcreatescanner" data-view=".view-main"><span
                                class="far fa-hdd aicon"></span>Opret scanner</a>
                    </div>
                    <div class="block">
                        <a href="/usergrouplist/" id="navuserlist" data-view=".view-main"><span
                                class="fas fa-list-ul aicon"></span>Bruger liste</a>
                    </div>
                    <div class="block">
                        <a href="/unknowncardlist/" id="navunknowncardlist" data-view=".view-main"><span
                                class="far fa-address-card aicon"></span>Ukendte kort liste</a>
                    </div>
                </div>
            </li>
            <li class="navright">
                <a href="/login/" id="navsignout" data-view=".view-main"><span
                        class="fas fa-sign-out-alt aicon"></span>Log ud</a>
            </li>
        </ul>
    </div>
</template>

<script>
    return {

        /**
         * Det datasæt som framework bruger internt i dette view, de kan ikke tilgås udefra.
         */
        data: function () {
            return {
                name,
            };
        },

        // Framework7 Component Methods
        methods: {
            toggleChevron(el) {
                el.toggleClass("fa-chevron-right");
                el.toggleClass("fa-chevron-down");
            }
        },
        on: {
            //pageMounted trigger når siden bliver indsat i DOMen
            pageMounted: function (page) {
                const that = this;
                that.name = (app.data['firstname'] + " " + app.data['lastname']);
                app.on('accordionOpen', function (el) {
                    that.toggleChevron($$(el).find('.dropboi'));
                });
                app.on('accordionClose', function (el) {
                    that.toggleChevron($$(el).find('.dropboi'));
                });
                if (app.data['isAdmin']) {
                    $$('#navadminaccordion').show();
                }
                $$('.usernamefield').html(that.name);
                $$('.profilepic').attr('src', app.data['userAvatar']);
                
                //Kode til at give den nuværende aktive route "active" klassen
                //Dette gøres nu dynamisk baseret på det mountede route i main viewet
                $$('a').filter(function (index, el) {
                    return ($$(this).attr('href') == `/${app.views.main.router.currentPageEl.dataset.name}/` && !$$(this).hasClass('centerlogo'))
                }).addClass('active');
            }
        },
    }


</script>